<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAQ Interactive - Agent IA Réel</title>
    
    <!-- 
    ====================================
    CONFIGURATION CHATBOT IA AVEC CLAUDE
    ====================================
    
    ÉTAPES POUR ACTIVER L'IA :
    
    1. Créer compte Anthropic :
       → Aller sur https://console.anthropic.com
       → S'inscrire avec email
       → Acheter crédits ($5 minimum)
    
    2. Obtenir clé API :
       → Dans console Anthropic
       → Aller dans "API Keys"
       → Créer nouvelle clé
       → Copier la clé (sk-ant-xxxx...)
    
    3. Remplacer dans le code :
       → Ligne ~695: remplacer 'YOUR_CLAUDE_API_KEY' par votre vraie clé
       → Exemple: this.claudeApiKey = 'sk-ant-api03-xxx...';
    
    COÛT RÉALISTE :
    - 1000 conversations = ~0.50€ (Claude Haiku)
    - Limite sécurité : 200/mois = 0.10€ max
    - Modèle utilisé : Claude 3 Haiku (rapide + économique + qualité)
    
    AVANTAGES CLAUDE :
    ✅ Réponses COMPLÈTES (plus de coupure !)
    ✅ Qualité supérieure des réponses
    ✅ Limite mensuelle (200 conversations max)
    ✅ Limite par session (20 conversations)
    ✅ Gestion d'erreurs complète
    ✅ Fallback si API indisponible
    
    -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;450;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Styles Globaux -->
    <link rel="stylesheet" href="../../shared/global-variables.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--background-dark);
            color: var(--text-primary);
            line-height: 1.6;
        }
        
        .faq-section {
            padding: 80px 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .section-header {
            text-align: center;
            margin-bottom: 60px;
        }
        
        .section-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 16px;
            opacity: 0;
            animation: fadeInUp 0.8s ease-out forwards;
        }
        
        .section-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 450;
            opacity: 0;
            animation: fadeInUp 0.8s ease-out 0.2s forwards;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Layout Principal */
        .faq-layout {
            display: grid;
            grid-template-columns: 1fr 500px;
            gap: 60px;
            align-items: start;
        }
        
        /* FAQ Traditionnelle */
        .faq-traditional {
            opacity: 0;
            animation: fadeInUp 0.8s ease-out 0.4s forwards;
        }
        
        .faq-intro {
            margin-bottom: 40px;
        }
        
        .faq-intro h3 {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
        }
        
        .faq-intro p {
            color: var(--text-secondary);
            font-size: 1rem;
        }
        
        .faq-items {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .faq-item {
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(16px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .faq-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }
        
        .faq-question {
            padding: 24px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .faq-question h4 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            flex: 1;
        }
        
        .faq-icon {
            font-size: 1.2rem;
            color: var(--brand-primary);
            transition: transform 0.3s ease;
            margin-left: 16px;
        }
        
        .faq-item.active .faq-icon {
            transform: rotate(180deg);
        }
        
        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .faq-answer-content {
            padding: 0 24px 24px;
            color: var(--text-secondary);
            line-height: 1.6;
        }
        
        .faq-item.active .faq-answer {
            max-height: 200px;
        }
        
        /* Chatbot Container */
        .chatbot-container {
            position: sticky;
            top: 100px;
            opacity: 0;
            animation: fadeInUp 0.8s ease-out 0.6s forwards;
        }
        
        .chatbot-header {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 20px 20px 8px 8px;
            padding: 20px;
            text-align: center;
        }
        
        .demo-badge {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-cyan));
            color: #ffffff;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 12px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .chatbot-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .chatbot-subtitle {
            font-size: 0.95rem;
            color: var(--text-secondary);
        }
        
        /* Chat Interface */
        .chat-interface {
            background: rgba(255, 255, 255, 0.04);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 8px 8px 20px 20px;
            border-top: none;
            height: 400px;
            display: flex;
            flex-direction: column;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }
        
        .message {
            max-width: 80%;
            word-wrap: break-word;
            animation: slideInMessage 0.3s ease-out;
        }
        
        @keyframes slideInMessage {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .message.bot {
            align-self: flex-start;
        }
        
        .message.user {
            align-self: flex-end;
        }
        
        .message-bubble {
            padding: 12px 16px;
            border-radius: 16px;
            font-size: 0.95rem;
            line-height: 1.4;
        }
        
        .message.bot .message-bubble {
            background: rgba(79, 70, 229, 0.15);
            border: 1px solid rgba(79, 70, 229, 0.2);
            color: var(--text-primary);
        }
        
        .message.user .message-bubble {
            background: rgba(139, 92, 246, 0.2);
            border: 1px solid rgba(139, 92, 246, 0.3);
            color: var(--text-primary);
        }
        
        .typing-indicator {
            display: none;
            align-self: flex-start;
            padding: 12px 16px;
            background: rgba(79, 70, 229, 0.15);
            border: 1px solid rgba(79, 70, 229, 0.2);
            border-radius: 16px;
            color: var(--text-secondary);
            font-style: italic;
        }
        
        .typing-dots {
            display: inline-block;
        }
        
        .typing-dots::after {
            content: '';
            animation: typingDots 1.5s infinite;
        }
        
        @keyframes typingDots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
        
        /* Chat Input */
        .chat-input-container {
            padding: 16px;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
        }
        
        .chat-input-wrapper {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .chat-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 12px;
            padding: 12px 16px;
            color: var(--text-primary);
            font-size: 0.95rem;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .chat-input:focus {
            border-color: var(--primary-blue);
            background: rgba(255, 255, 255, 0.1);
        }
        
        .chat-input::placeholder {
            color: var(--text-secondary);
        }
        
        .chat-send-btn {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-cyan));
            border: none;
            border-radius: 12px;
            padding: 12px 16px;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .chat-send-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
        }
        
        .chat-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Quick Questions */
        .quick-questions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }
        
        .quick-question {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .quick-question:hover {
            background: rgba(79, 70, 229, 0.15);
            border-color: rgba(79, 70, 229, 0.3);
            color: var(--text-primary);
        }
        
        /* Contact Form (Hidden by default) */
        .contact-form {
            display: none;
            padding: 20px;
            background: rgba(255, 255, 255, 0.04);
            border-top: 1px solid rgba(255, 255, 255, 0.08);
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 6px;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        .form-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 8px;
            padding: 12px;
            color: var(--text-primary);
            font-size: 0.95rem;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            border-color: var(--primary-blue);
            background: rgba(255, 255, 255, 0.1);
        }
        
        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .form-submit {
            width: 100%;
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-cyan));
            border: none;
            border-radius: 12px;
            padding: 14px;
            color: #ffffff;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .form-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(79, 70, 229, 0.3);
        }
        
        .form-submit:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Success Message */
        .success-message {
            display: none;
            padding: 20px;
            background: rgba(34, 197, 94, 0.15);
            border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 12px;
            color: #ffffff;
            text-align: center;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .faq-layout {
                grid-template-columns: 1fr;
                gap: 40px;
            }
            
            .chatbot-container {
                position: static;
                order: -1;
            }
            
            .section-title {
                font-size: 2rem;
            }
            
            .faq-section {
                padding: 60px 16px;
            }
        }
    </style>
</head>
<body>
    
    <section class="faq-section" id="faq">
        <div class="section-header">
            <h2 class="section-title">Questions Fréquentes</h2>
            <p class="section-subtitle">Trouvez rapidement les réponses à vos questions ou testez mon Assistant IA</p>
        </div>
        
        <div class="faq-layout">
            <!-- FAQ Traditionnelle -->
            <div class="faq-traditional">
                <div class="faq-intro">
                    <h3>Questions les plus posées</h3>
                    <p>Voici les réponses aux questions que mes clients me posent le plus souvent.</p>
                </div>
                
                <div class="faq-items">
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Combien coûte un audit de mes processus ?</h4>
                            <span class="faq-icon">↓</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                L'audit complet de vos processus coûte 250€. Il inclut l'analyse approfondie de votre organisation, l'identification des optimisations possibles et une roadmap personnalisée avec estimations de ROI.
                            </div>
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Quels délais pour la livraison des projets ?</h4>
                            <span class="faq-icon">↓</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                • Audit : 48h après validation<br>
                                • Automatisation simple : 1-2 semaines<br>
                                • Dashboard BI : 2-3 semaines<br>
                                • Assistant IA : 2-4 semaines<br>
                                Formation complète incluse dans chaque projet.
                            </div>
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Quels outils et technologies utilisez-vous ?</h4>
                            <span class="faq-icon">↓</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                • Power BI pour la Business Intelligence<br>
                                • Make.com et Zapier pour l'automatisation<br>
                                • WordPress/WooCommerce pour l'e-commerce<br>
                                • APIs diverses pour les intégrations<br>
                                • Solutions no-code prioritaires pour votre autonomie
                            </div>
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>La formation est-elle incluse ?</h4>
                            <span class="faq-icon">↓</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                Oui, 100% ! Chaque projet inclut une formation complète pour votre équipe, une documentation détaillée, et 30 jours de support post-livraison. Mon objectif : votre totale autonomie.
                            </div>
                        </div>
                    </div>
                    
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Travaillez-vous avec toutes les tailles d'entreprise ?</h4>
                            <span class="faq-icon">↓</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                Je me spécialise dans les PME et startups (5-50 employés) qui n'ont pas d'équipe tech dédiée mais veulent l'efficacité des grandes entreprises. Chaque solution est adaptée à votre budget et vos besoins.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Chatbot Assistant IA -->
            <div class="chatbot-container">
                <div class="chatbot-header">
                    <div class="demo-badge">🧠 AGENT IA AVANCÉ</div>
                    <h3 class="chatbot-title">Assistant IA de Sofiane</h3>
                    <p class="chatbot-subtitle">Intelligence artificielle réelle - Conversations naturelles sur l'automatisation !</p>
                </div>
                
                <div class="chat-interface">
                    <div class="chat-messages" id="chatMessages">
                        <div class="message bot">
                            <div class="message-bubble">
                                Bonjour ! Je suis l'assistante IA de Sofiane. Il transforme la complexité technique en solutions simples que vos équipes adoptent naturellement. Une question sur l'automatisation ?
                            </div>
                        </div>
                        <div class="typing-indicator" id="typingIndicator">
                            <span class="typing-dots">Je réfléchis</span>
                        </div>
                    </div>
                    
                    <div class="chat-input-container" id="chatInputContainer">
                        <div class="chat-input-wrapper">
                            <input type="text" class="chat-input" id="chatInput" placeholder="Tapez votre question ici...">
                            <button class="chat-send-btn" id="chatSendBtn">Envoyer</button>
                        </div>
                        <div class="quick-questions" id="quickQuestions">
                            <span class="quick-question">💰 Tarifs</span>
                            <span class="quick-question">⏱️ Délais</span>
                            <span class="quick-question">🔧 Outils</span>
                            <span class="quick-question">📚 Formation</span>
                        </div>
                    </div>
                    
                    <!-- Contact Form (hidden) -->
                    <div class="contact-form" id="contactForm">
                        <h4 style="margin-bottom: 16px; color: var(--text-primary);">Parlons de votre projet !</h4>
                        <form id="leadForm">
                            <div class="form-group">
                                <label class="form-label">Nom *</label>
                                <input type="text" class="form-input" id="userName" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email *</label>
                                <input type="email" class="form-input" id="userEmail" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Votre demande</label>
                                <textarea class="form-input form-textarea" id="userMessage" placeholder="Décrivez brièvement votre projet ou question..."></textarea>
                            </div>
                            <button type="submit" class="form-submit">Envoyer à Sofiane</button>
                        </form>
                    </div>
                    
                    <!-- Success Message -->
                    <div class="success-message" id="successMessage">
                        <h4>✅ Message envoyé !</h4>
                        <p>Sofiane vous recontactera sous 24h avec une réponse personnalisée.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // FAQ Accordion
        document.querySelectorAll('.faq-question').forEach(question => {
            question.addEventListener('click', () => {
                const item = question.parentElement;
                const isActive = item.classList.contains('active');
                
                // Close all items
                document.querySelectorAll('.faq-item').forEach(faqItem => {
                    faqItem.classList.remove('active');
                });
                
                // Open clicked item if it wasn't active
                if (!isActive) {
                    item.classList.add('active');
                }
            });
        });
        
        // Chatbot Logic with Groq AI
        class ChatBot {
            constructor() {
                this.messagesContainer = document.getElementById('chatMessages');
                this.chatInput = document.getElementById('chatInput');
                this.sendButton = document.getElementById('chatSendBtn');
                this.typingIndicator = document.getElementById('typingIndicator');
                this.contactForm = document.getElementById('contactForm');
                this.chatInputContainer = document.getElementById('chatInputContainer');
                this.conversationCount = 0;
                this.maxConversations = 20; // Increased limit for real AI
                this.monthlyLimit = 200; // Safety limit
                this.conversationHistory = [];
                
                // Configuration Claude
                this.claudeApiKey = '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';
                this.claudeModel = 'claude-3-haiku-20240307'; // Claude Haiku model
                
                this.initializeEventListeners();
                this.initializeQuickQuestions();
                this.checkMonthlyUsage();
            }
            
            checkMonthlyUsage() {
                const currentMonth = new Date().getMonth();
                const storedMonth = localStorage.getItem('chatbot_month');
                const monthlyCount = parseInt(localStorage.getItem('chatbot_monthly_count') || '0');
                
                if (storedMonth != currentMonth) {
                    // Reset monthly counter
                    localStorage.setItem('chatbot_month', currentMonth);
                    localStorage.setItem('chatbot_monthly_count', '0');
                } else if (monthlyCount >= this.monthlyLimit) {
                    this.showMonthlyLimitReached();
                    return false;
                }
                return true;
            }
            
            showMonthlyLimitReached() {
                this.addMessage(
                    "🚫 Limite mensuelle atteinte ! Pour continuer à échanger, contactez Sofiane directement. Il sera ravi de vous aider personnellement ! 😊",
                    'bot'
                );
                this.showContactForm();
            }
            
            initializeEventListeners() {
                this.sendButton.addEventListener('click', () => this.sendMessage());
                this.chatInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.sendMessage();
                });
                
                // Lead form submission
                document.getElementById('leadForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.submitLead();
                });
            }
            
            initializeQuickQuestions() {
                document.querySelectorAll('.quick-question').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const question = btn.textContent;
                        this.handleQuickQuestion(question);
                    });
                });
            }
            
            async handleQuickQuestion(question) {
                let questionText = '';
                
                if (question.includes('Tarifs') || question.includes('💰')) {
                    questionText = "Quels sont vos tarifs ?";
                } else if (question.includes('Délais') || question.includes('⏱️')) {
                    questionText = "Quels sont vos délais de livraison ?";
                } else if (question.includes('Outils') || question.includes('🔧')) {
                    questionText = "Quels outils utilisez-vous ?";
                } else if (question.includes('Formation') || question.includes('📚')) {
                    questionText = "La formation est-elle incluse ?";
                }
                
                this.addMessage(questionText, 'user');
                this.conversationCount++;
                
                if (!this.checkMonthlyUsage()) return;
                
                // Add to conversation history
                this.conversationHistory.push({role: "user", content: questionText});
                
                this.showTyping();
                
                try {
                    const response = await this.getClaudeResponse(questionText);
                    this.hideTyping();
                    this.addMessage(response, 'bot');
                    
                    // Add bot response to history
                    this.conversationHistory.push({role: "assistant", content: response});
                    
                    // Update monthly counter
                    const currentCount = parseInt(localStorage.getItem('chatbot_monthly_count') || '0');
                    localStorage.setItem('chatbot_monthly_count', (currentCount + 1).toString());
                    
                    this.checkConversationLimit();
                } catch (error) {
                    this.hideTyping();
                    this.addMessage("Désolé, petit souci technique. Reformulez votre question ou contactez Sofiane directement ! 😊", 'bot');
                    console.error('Claude API Error:', error);
                }
            }
            
            async sendMessage() {
                const message = this.chatInput.value.trim();
                if (!message) return;
                
                if (!this.checkMonthlyUsage()) return;
                
                this.addMessage(message, 'user');
                this.chatInput.value = '';
                this.conversationCount++;
                
                // Add to conversation history
                this.conversationHistory.push({role: "user", content: message});
                
                // Show typing indicator
                this.showTyping();
                this.sendButton.disabled = true;
                
                try {
                    // Get AI response from Claude
                    const response = await this.getClaudeResponse(message);
                    this.hideTyping();
                    this.addMessage(response, 'bot');
                    
                    // Add bot response to history
                    this.conversationHistory.push({role: "assistant", content: response});
                    
                    // Update monthly counter
                    const currentCount = parseInt(localStorage.getItem('chatbot_monthly_count') || '0');
                    localStorage.setItem('chatbot_monthly_count', (currentCount + 1).toString());
                    
                    this.checkConversationLimit();
                } catch (error) {
                    console.error('Claude API Error:', error);
                    this.hideTyping();
                    this.addMessage(
                        "🤖 Agent IA temporairement indisponible. Démarrez le serveur proxy (instructions dans le code) ou contactez Sofiane directement ! 😊",
                        'bot'
                    );
                }
                
                this.sendButton.disabled = false;
            }
            
            async getClaudeResponse(userMessage) {
                const systemPrompt = `Tu es l'assistante charmante de Sofiane Dehaffreingue, expert automatisation PME. Tu es gentille, souriante mais très pro !

PROFIL COMPLET SOFIANE :
- 25 ans, Master 2 Management & Commerce International spé Data/IA (Université Polytechnique Hauts-de-France)
- 6 mois École Internationale Française Tokyo (15 professeurs formés, système bulletins transformé)
- Compétences Power BI niveau intermédiaire (pas expert!), DAX simple, dashboards autonome
- Hubi Paris: 483€ CA réel, 11 commandes, automatisation complète
- SafeCharm: 2ème place concours (pas 1ère!), leadership équipe 4-5 étudiants
- Langues: FR natif, Anglais C1, Espagnol B1 (Erasmus Santander)
- Recherche stage validation M2 (3-6 mois)

SERVICES DÉTAILLÉS :
- Audit processus : 250€ (48h) - Analyse complète + roadmap ROI
- Automatisation : 500€ (1-2 sem) - Workflows, emails, CRM, facturation
- Dashboard BI : 800€ (2-3 sem) - Power BI, KPIs temps réel, formation
- Assistant IA : 600€ (2-4 sem) - Chatbot intelligent, lead generation

COMPÉTENCES RÉELLES :
Power BI intermédiaire (dashboards, DAX simple, pas expert), Excel avancé TCD, Make/Zapier concepts, WordPress admin, SQL débutant

PROJETS CONCRETS RÉALISÉS :
- EIFJ Tokyo: Formation 15 professeurs, bulletins chaos → système organisé, 100% adoption
- Hubi Paris: Site e-commerce créé, 483€ CA réel, 11 commandes, bugs résolus
- SafeCharm: 2ème place concours, leadership équipe, analyses data pour jury
- Restaurant: Management 15 personnes, formation processus, amélioration efficacité
- Dashboard exemple 48k€: Projet illustratif capacités (pas client réel)

SECTEURS : E-commerce, éducation, services, formation, consulting international

MÉTHODE DE TRAVAIL :
- Méthodologie en 3 étapes : Analyse → Solution Design → Déploiement
- Approche PME : langage accessible, pas de corporate compliqué
- Design moderne : glassmorphisme, animations fluides GSAP
- Portfolio concret avec portfolio visuel des transformations réelles
- 4 vidéos démo disponibles : data-analytics, automation, hero-background, ai-integration

PHILOSOPHIE SOFIANE :
- "Traducteur business-tech" - complexité technique → solutions simples adoptées naturellement
- Formation incluse toujours (méthode EIFJ prouvée: 100% adoption sans résistance)
- Auto-formation continue, apprentissage rapide (Power BI 0 → intermédiaire en 6 mois)
- Leadership collaboratif multiculturel (France-Japon validé)
- Vision: Digital nomad Japon, expertise automatisation accessible PME
- Honnêteté sur limites: étudiant cherchant stage, compétences intermédiaires pas expert

RÈGLES ABSOLUES À RESPECTER :
🚫 INTERDICTION TOTALE DE NÉGOCIER - Les tarifs sont FIXES, point final !
🚫 JAMAIS de remises, rabais, prix différents - JAMAIS !
🚫 JAMAIS donner conseils gratuits (rediriger gentiment)
✅ Rester sur services Sofiane uniquement
✅ RÉPONSES CONCISES ET COMPLÈTES - Crush les doutes des prospects !
✅ ATTENTION: Tokyo = lieu de STAGE (6 mois), université = UPHF
✅ Réponds aux questions pour CONVERTIR les leads, pas les frustrer
✅ Donne assez d'infos pour rassurer mais redirige si trop technique
✅ Sois vendeuse intelligente, mais FERME sur les prix !

RÉPONSES TYPES OBLIGATOIRES :
Questions normales: Réponds simplement sur les services, tarifs, délais
Si négociation/prix réduit: "Désolée, les tarifs sont fixes ! Mais Sofiane étudie chaque projet pour la meilleure solution adaptée à vos besoins 😊 Contactez-le pour discuter !"
Si "je suis pauvre/pas d'argent": "Je comprends les contraintes budgétaires. Sofiane propose des solutions évolutives - commencez par l'audit 250€ pour identifier les gains prioritaires ! Contactez-le 😊"
Si conseil gratuit: "Sofiane répond à ça dans ses audits professionnels ! 😉"  
Si hors-sujet: "Je m'occupe que des services de Sofiane 😊"
Après 2-3 échanges: "N'hésitez pas à contacter Sofiane directement, il sera ravi de vous aider !"

FORMAT CONVERSATIONNEL NATUREL :
- JAMAIS d'étoiles *, de puces, de listes formatées !
- Parler comme une vraie assistante, pas un document
- Si trop de détails demandés → Donner l'essentiel puis rediriger
- Questions parcours → "Sofiane a 25 ans, Master Data/IA à l'UPHF, 6 mois stage Tokyo. Pour tout son parcours détaillé, section À Propos !"
- Style: Conversationnel, pas copié-collé !
OBJECTIF: Conversation naturelle qui convertit, pas listing de CV !

Sois souriante, professionnelle et légèrement complice avec tes émojis !`;

                // Build conversation history for Claude format
                const messages = [];
                
                // Add conversation history
                for (let i = Math.max(0, this.conversationHistory.length - 6); i < this.conversationHistory.length; i++) {
                    const msg = this.conversationHistory[i];
                    messages.push({
                        role: msg.role === "assistant" ? "assistant" : "user",
                        content: msg.content
                    });
                }
                
                // Add current user message
                messages.push({
                    role: "user", 
                    content: userMessage
                });

                const response = await fetch('http://localhost:3001/api/claude', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        apiKey: this.claudeApiKey,
                        model: this.claudeModel,
                        max_tokens: 200,
                        system: systemPrompt,
                        messages: messages
                    })
                });

                if (!response.ok) {
                    throw new Error(`Claude API error: ${response.status}`);
                }

                const data = await response.json();
                return data.content[0].text;
            }
            
            shouldUseFallback(userMessage) {
                // Essayer d'abord la vraie API Claude
                return false;
            }
            
            getFallbackResponse(userMessage) {
                const msg = userMessage.toLowerCase();
                
                // Réponses intelligentes basées sur mots-clés
                if (msg.includes('tarif') || msg.includes('prix') || msg.includes('coût') || msg.includes('€')) {
                    return "Voici mes tarifs : Audit processus 250€ (48h), Automatisation 500€ (1-2 sem), Dashboard BI 800€ (2-3 sem), Assistant IA 600€ (2-4 sem). Formation incluse ! Pour discuter de votre projet spécifique, contactez Sofiane directement 😊";
                }
                
                if (msg.includes('délai') || msg.includes('temps') || msg.includes('durée') || msg.includes('livraison')) {
                    return "Les délais de Sofiane : Audit 48h après validation, Automatisation 1-2 semaines, Dashboard BI 2-3 semaines, Assistant IA 2-4 semaines. Chaque projet inclut formation complète et 30j de support ! Besoin d'urgence ? Contactez-le directement 🚀";
                }
                
                if (msg.includes('outil') || msg.includes('technologie') || msg.includes('power bi') || msg.includes('logiciel')) {
                    return "Sofiane utilise Power BI (niveau intermédiaire), Make.com et Zapier pour l'automatisation, WordPress/WooCommerce pour l'e-commerce, plus diverses APIs. Approche no-code prioritaire pour votre autonomie ! Questions techniques spécifiques ? Il vous explique tout en détail 😉";
                }
                
                if (msg.includes('formation') || msg.includes('apprentissage') || msg.includes('support')) {
                    return "Oui, la formation est 100% incluse dans chaque projet ! Sofiane forme votre équipe, fournit une documentation complète et 30 jours de support post-livraison. Son objectif : votre totale autonomie. Méthode prouvée au Japon avec 100% d'adoption 🎯";
                }
                
                if (msg.includes('parcours') || msg.includes('expérience') || msg.includes('études') || msg.includes('japon') || msg.includes('tokyo')) {
                    return "Sofiane a 25 ans, Master Data/IA à l'UPHF, 6 mois de stage à l'École Internationale Française de Tokyo où il a formé 15 professeurs. Projets réalisés : Hubi Paris (483€ CA), SafeCharm (2ème place concours). Pour tout son parcours détaillé, consultez la section À Propos ! 🌟";
                }
                
                if (msg.includes('entreprise') || msg.includes('taille') || msg.includes('pme') || msg.includes('startup')) {
                    return "Sofiane se spécialise dans les PME et startups (5-50 employés) qui n'ont pas d'équipe tech dédiée mais veulent l'efficacité des grandes entreprises. Chaque solution est adaptée à votre budget et vos besoins spécifiques ! 💼";
                }
                
                if (msg.includes('remise') || msg.includes('rabais') || msg.includes('négoci') || msg.includes('moins cher')) {
                    return "Les tarifs sont fixes 😊 mais chaque projet est étudié selon vos besoins spécifiques ! Sofiane propose toujours la solution la plus adaptée à votre budget. Parlons de votre projet pour voir comment vous aider au mieux !";
                }
                
                if (msg.includes('processus') || msg.includes('méthode') || msg.includes('comment') || msg.includes('étapes')) {
                    return "Méthodologie Sofiane en 3 étapes : 1) Analyse approfondie de vos processus actuels 2) Design de solution personnalisée 3) Déploiement avec formation équipe. Approche PME avec langage accessible, pas de jargon technique ! Envie de voir ça en détail ? Contactez-le 🔄";
                }
                
                // Question par défaut
                return "Excellente question ! Sofiane sera ravi de vous répondre en détail selon votre situation spécifique. Ses services : Audit 250€, Automatisation 500€, Dashboard BI 800€, Assistant IA 600€. Formation toujours incluse ! Pour discuter de votre projet, contactez-le directement 😊";
            }
            
            detectComplexQuestion(message) {
                const msg = message.toLowerCase();
                
                // Questions qui nécessitent plus de détails
                const complexKeywords = [
                    'comment', 'pourquoi', 'expliquer', 'détail', 'processus', 'méthode',
                    'formation', 'expérience', 'projet', 'parcours', 'différence',
                    'avantage', 'fonctionnement', 'étapes', 'workflow', 'exemple',
                    'quelle', 'quels', 'combien', 'niveau', 'spécialité', 'langues'
                ];
                
                // Questions multiples ou très longues = beaucoup plus de tokens
                const isVeryLongQuestion = message.length > 100;
                const hasMultipleQuestions = (message.match(/\?/g) || []).length > 2;
                const isLongQuestion = message.length > 50;
                const hasComplexKeyword = complexKeywords.some(keyword => msg.includes(keyword));
                
                if (isVeryLongQuestion || hasMultipleQuestions) return "very_long";
                if (isLongQuestion || hasComplexKeyword) return "long";
                return "short";
            }
            
            checkConversationLimit() {
                if (this.conversationCount >= this.maxConversations) {
                    setTimeout(() => {
                        this.addMessage(
                            "Pour continuer notre échange et avoir des réponses personnalisées à votre situation, laissez-moi vos coordonnées ! Sofiane vous recontactera sous 24h avec des conseils sur-mesure ! 🎯",
                            'bot'
                        );
                        this.showContactForm();
                    }, 1000);
                }
            }
            
            showContactForm() {
                this.chatInputContainer.style.display = 'none';
                this.contactForm.style.display = 'block';
            }
            
            showTyping() {
                this.typingIndicator.style.display = 'block';
                this.messagesContainer.scrollTop = this.messagesContainer.scrollHeight;
            }
            
            hideTyping() {
                this.typingIndicator.style.display = 'none';
            }
            
            addMessage(text, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}`;
                
                const bubbleDiv = document.createElement('div');
                bubbleDiv.className = 'message-bubble';
                bubbleDiv.textContent = text;
                
                messageDiv.appendChild(bubbleDiv);
                
                // Insert before typing indicator
                this.messagesContainer.insertBefore(messageDiv, this.typingIndicator);
                
                // Scroll to bottom
                setTimeout(() => {
                    this.messagesContainer.scrollTop = this.messagesContainer.scrollHeight;
                }, 100);
            }
            
            async submitLead() {
                const name = document.getElementById('userName').value;
                const email = document.getElementById('userEmail').value;
                const message = document.getElementById('userMessage').value;
                
                if (!name || !email) {
                    alert('Veuillez remplir tous les champs obligatoires');
                    return;
                }
                
                const submitButton = document.querySelector('.form-submit');
                submitButton.disabled = true;
                submitButton.textContent = 'Envoi en cours...';
                
                try {
                    // Simulate sending email
                    await this.sendEmailNotification(name, email, message);
                    
                    // Show success message
                    this.contactForm.style.display = 'none';
                    document.getElementById('successMessage').style.display = 'block';
                    
                } catch (error) {
                    alert('Erreur lors de l\'envoi. Veuillez réessayer.');
                    submitButton.disabled = false;
                    submitButton.textContent = 'Envoyer à Sofiane';
                }
            }
            
            async sendEmailNotification(name, email, message) {
                // Simulate API call - in production, this would send to your backend
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Log the lead info (replace with actual email sending)
                const leadInfo = {
                    timestamp: new Date().toISOString(),
                    name: name,
                    email: email,
                    message: message,
                    source: 'Chatbot IA - Site Web'
                };
                
                console.log('NOUVEAU LEAD CHATBOT:', leadInfo);
                
                // In production, send this to sofianedehaf@gmail.com
                // Subject: "CHATBOT SITE WEB - Nouveau contact"
                return true;
            }
        }
        
        // Initialize chatbot when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new ChatBot();
        });
    </script>

</body>
</html>